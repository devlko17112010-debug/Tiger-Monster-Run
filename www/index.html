<!doctype html><html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'><title>Tiger Monster Run</title><style>html,body{margin:0;background:#000;color:#fff;font-family:system-ui}canvas{display:block;width:100vw;height:100vh;image-rendering:pixelated}.hud{position:fixed;top:8px;left:8px;display:flex;gap:8px;z-index:10}.hud span,.hud button{background:rgba(0,0,0,.5);padding:6px 10px;border-radius:8px;border:1px solid #333;color:#fff}.controls{position:fixed;inset:0;pointer-events:none}.pad{position:absolute;bottom:14px;display:flex;gap:8px;pointer-events:auto}.left{left:14px}.right{right:14px;flex-direction:column}.btn{background:#7a7a7a;color:#fff;font-weight:900;border-radius:12px;padding:12px 16px;min-width:56px;text-align:center;box-shadow:inset 0 -3px 0 rgba(0,0,0,.35)}.small{padding:10px 12px;min-width:46px}.round{border-radius:40px;min-width:70px}.overlay{position:fixed;inset:0;background:rgba(0,0,0,.7);display:none;align-items:center;justify-content:center;z-index:20}.panel{background:#141414;border:1px solid #333;border-radius:12px;padding:16px;width:min(92vw,720px)}.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:10px}</style></head><body><canvas id='c' width='960' height='540'></canvas><div class='hud'><span id='lvl'></span><span id='coins'></span><span id='gems'></span><span id='lives'></span><button id='storeBtn'>Store</button><button id='acctBtn'>Account</button><button id='pauseBtn'>Pause</button></div><div class='controls'><div class='pad left'><div class='btn small' id='left'>←</div><div class='btn small' id='right'>→</div><div class='btn small' id='jump'>↑</div><div class='btn small' id='hi'>↑↑</div></div><div class='pad right'><div style='display:flex;gap:8px;justify-content:flex-end'><div class='btn round' id='shoot'>Shoot</div><div class='btn round' id='boost'>Boost</div></div></div></div><div class='overlay' id='pause'><div class='panel'><h2>Paused</h2><label><input type='checkbox' id='music'> Music</label><label style='margin-left:10px'><input type='checkbox' id='sfx'> SFX</label><div style='margin-top:10px;display:flex;gap:8px'><button id='resume'>Resume</button><button id='restart'>Restart</button><button id='main'>Main Menu</button></div><hr><h3>Invite Friends</h3><div style='display:flex;gap:8px'><input id='friendName' placeholder='Friend name' style='flex:1'><button id='addFriend'>Add</button></div><ul id='friends'></ul></div></div><div class='overlay' id='auth'><div class='panel'><h2>Welcome to Tiger Monster Run</h2><p>Sign in, register or play as guest.</p><div style='display:flex;gap:8px;margin-bottom:8px'><label><input type='checkbox' id='musicM'> Music</label><label><input type='checkbox' id='sfxM'> SFX</label></div><div style='display:flex;gap:8px;margin-bottom:8px'><button id='loginBtn'>Sign in / Log in</button><button id='regBtn'>Register / Create Account</button><button id='guestBtn'>Play as Guest</button></div><form id='login' style='display:none;gap:8px'><input name='name' placeholder='Name' required><input name='pass' placeholder='Password' type='password' required><button type='submit'>Log in</button><button type='button' id='b1'>Back</button></form><form id='reg' style='display:none;gap:8px'><input name='name' placeholder='Name' required><input name='pass' placeholder='Password' type='password' required><button type='submit'>Create</button><button type='button' id='b2'>Back</button></form></div></div><div class='overlay' id='store'><div class='panel'><h2>Store</h2><p>All items ≤ 130 coins. Premium can use gems.</p><h3>Costumes</h3><div class='grid' id='coinGrid'></div><h3>Premium</h3><div class='grid' id='gemGrid'></div></div></div><script>const W=960,H=540;const c=document.getElementById('c'),x=c.getContext('2d');function bg(n){return`hsl(${(n*37)%360} 60% 45%)`}const S={lvl:1,coins:0,gems:0,lives:3,music:JSON.parse(localStorage.getItem('tmr_m')||'true'),sfx:JSON.parse(localStorage.getItem('tmr_s')||'true'),friends:JSON.parse(localStorage.getItem('tmr_f')||'[]')};const P={x:60,y:0,w:42,h:42,vx:0,vy:0,face:1,can:true};let M=[],B=[],CNS=[],GAPS=[],PORT={x:W-44,y:H-90,r:22};const G=0.6,F=0.86,SPD=0.9,JV=-12.5,BLT=10;const keys={};document.addEventListener('keydown',e=>{keys[e.key]=true});document.addEventListener('keyup',e=>{keys[e.key]=false});['left','right','jump','hi','shoot','boost'].forEach(id=>{const q=id=>document.getElementById(id);q(id).addEventListener('touchstart',e=>{e.preventDefault();keys[id]=true});q(id).addEventListener('touchend',e=>{e.preventDefault();keys[id]=false});q(id).addEventListener('mousedown',e=>{e.preventDefault();keys[id]=true});q(id).addEventListener('mouseup',e=>{e.preventDefault();keys[id]=false})});function ui(){lvl.textContent='Lvl '+S.lvl;coins.textContent='Coins '+S.coins;gems.textContent='Gems '+S.gems;lives.textContent='Lives '+S.lives}function store(o){document.getElementById('store').style.display=o?'flex':'none'; if(o) fillStore()}storeBtn.onclick=()=>store(document.getElementById('store').style.display!=='flex'); pauseBtn.onclick=()=>pause(true); resume.onclick=()=>pause(false); restart.onclick=()=>{gen(S.lvl);pause(false)}; main.onclick=()=>{S.lvl=1;gen(1);pause(false)}; acctBtn.onclick=()=>auth(true); function pause(v){document.getElementById('pause').style.display=v?'flex':'none'}function auth(v){document.getElementById('auth').style.display=v?'flex':'none'}music.checked=S.music; sfx.checked=S.sfx; musicM.checked=S.music; sfxM.checked=S.sfx; music.onchange=(e)=>{S.music=e.target.checked;localStorage.setItem('tmr_m',JSON.stringify(S.music))}; sfx.onchange=(e)=>{S.sfx=e.target.checked;localStorage.setItem('tmr_s',JSON.stringify(S.sfx))}; musicM.onchange=(e)=>{S.music=e.target.checked;localStorage.setItem('tmr_m',JSON.stringify(S.music))}; sfxM.onchange=(e)=>{S.sfx=e.target.checked;localStorage.setItem('tmr_s',JSON.stringify(S.sfx))}; loginBtn.onclick=()=>{login.style.display='flex';reg.style.display='none'}; regBtn.onclick=()=>{reg.style.display='flex';login.style.display='none'}; guestBtn.onclick=()=>auth(false); b1.onclick=()=>{login.style.display='none'}; b2.onclick=()=>{reg.style.display='none'}; addFriend.onclick=()=>{const name=friendName.value.trim(); if(!name) return; const id=''+Math.floor(100000+Math.random()*900000); S.friends.push({name,id}); localStorage.setItem('tmr_f',JSON.stringify(S.friends)); listFriends(); gen(S.lvl)}; function listFriends(){friends.innerHTML=''; S.friends.forEach(f=>{const li=document.createElement('li'); li.textContent=f.name+' #'+f.id; friends.appendChild(li)})}listFriends(); const coinItems=[{name:'Classic Tiger',price:0,type:'costume'},{name:'Jungle Camo',price:60,type:'costume'},{name:'Snow Tiger',price:120,type:'costume'},{name:'Neon Runner',price:130,type:'costume'}]; const gemItems=[{name:'Quartz Rail',coin:130,gem:8,type:'weapon'},{name:'Sapphire Beam',coin:130,gem:14,type:'weapon'},{name:'Ruby Nova',coin:130,gem:20,type:'weapon'},{name:'Obsidian Lance',coin:130,gem:32,type:'weapon'}]; let owned=new Set(['Classic Tiger']), weapon='Pea Blaster', costume='Classic Tiger'; function fillStore(){coinGrid.innerHTML=''; gemGrid.innerHTML=''; coinItems.forEach(it=>{const d=document.createElement('div'); d.className='card'; d.innerHTML=`<b>${it.name}</b><div>${it.price}c</div>`; const b=document.createElement('button'); b.textContent=owned.has(it.name)?'Equip':'Buy'; b.onclick=()=>{if(owned.has(it.name)){costume=it.name}else if(S.coins>=it.price){S.coins-=it.price;owned.add(it.name);costume=it.name;ui()}else alert('Not enough coins'); fillStore()}; d.appendChild(b); coinGrid.appendChild(d)}); gemItems.forEach(it=>{const d=document.createElement('div'); d.className='card'; d.innerHTML=`<b>${it.name}</b><div>${it.coin}c / ${it.gem}g</div>`; const bc=document.createElement('button'); bc.textContent='Buy (Coins)'; bc.onclick=()=>{if(S.coins>=it.coin){S.coins-=it.coin;owned.add(it.name);if(it.type==='weapon')weapon=it.name;else costume=it.name;ui()}else alert('Not enough coins')}; const bg=document.createElement('button'); bg.textContent='Buy (Gems)'; bg.onclick=()=>{if(S.gems>=it.gem){S.gems-=it.gem;owned.add(it.name);if(it.type==='weapon')weapon=it.name;else costume=it.name;ui()}else alert('Not enough gems')}; d.appendChild(bc); d.appendChild(bg); gemGrid.appendChild(d)})}function rnd(seed){return ()=>{seed=(seed*1664525+1013904223)%4294967296;return seed/4294967296}}let MOBS=[],CNS=[],GAPS=[],PORT={x:0,y:0,r:24}; function gen(n){const DIFF=Math.pow(1.2,Math.max(0,Math.floor((n-1)/2))); M=[];B=[];CNS=[];GAPS=[];P.x=60;P.y=H-120;P.vx=0;P.vy=0;P.can=true; let R=rnd(n*1337); let mC=Math.min(20,Math.max(2,Math.floor(2*DIFF))); for(let i=0;i<mC;i++){let sz=26+R()*20, sp=(0.8+R()*1.2)*DIFF, mx=160+R()*(W-280); M.push({x:mx,y:H-80-sz,w:sz,h:sz,vx:sp,dir:R()<0.5?-1:1})} let cC=Math.min(25,6+Math.floor(3*DIFF)); for(let i=0;i<cC;i++){let cx=120+R()*(W-200), cy=H-120-R()*140; CNS.push({x:cx,y:cy,r:8,t:false,v:5})} let gC=Math.min(6,1+Math.floor((n-1)/2)); let maxGW=Math.min(140,40+((n-1)/2)*10); for(let i=0;i<gC;i++){let gw=40+R()*(maxGW-40), gx=120+R()*(W-240-gw); if(gx>80 && gx+gw<W-120) GAPS.push({x:gx,w:gw})} PORT={x:W-40,y:H-100,r:24}; ui()} function ground(xp){for(const g of GAPS){if(xp>=g.x && xp<=g.x+g.w) return Infinity} return H-80-20 } function rect(a,b){return a.x<b.x+b.w && a.x+a.w>b.x && a.y<b.y+b.h && a.y+a.h>b.y} function rco(r,c){const cx=Math.max(r.x,Math.min(c.x,r.x+r.w)),cy=Math.max(r.y,Math.min(c.y,r.y+r.h));const dx=c.x-cx,dy=c.y-cy;return dx*dx+dy*dy<=c.r*c.r} let bullets=[]; function shoot(){const dir=P.face>0?1:-1; bullets.push({x:P.x+P.w/2+dir*20,y:P.y+P.h/2-16,vx:10*dir,ttl:1200})} function step(){requestAnimationFrame(step); let L=keys['ArrowLeft']||keys['a']||keys['left'], Rr=keys['ArrowRight']||keys['d']||keys['right'], J=(keys[' ']||keys['ArrowUp']||keys['w']||keys['jump']), HJ=keys['hi']; if(L){P.vx-=0.9;P.face=-1} if(Rr){P.vx+=0.9;P.face=1} if(J && P.can){P.vy=-12.5;P.can=false} if(HJ && P.can){P.vy=-18.5;P.can=false} if(keys['shoot']){shoot(); keys['shoot']=false} if(keys['boost']){P.vx+=P.face*2.5; keys['boost']=false} P.vy+=0.6; P.x+=P.vx; P.y+=P.vy; P.vx*=0.86; const gy=ground(P.x+P.w/2); if(gy!==Infinity && P.y+P.h>=H-80){P.y=H-80-P.h;P.vy=0;P.can=true} if(P.x<0)P.x=0; if(P.x+P.w>W)P.x=W-P.w; bullets=bullets.filter(b=>b.ttl>0); bullets.forEach(b=>{b.x+=b.vx;b.ttl-=16}); M=M.filter(m=>{let hit=false; bullets.forEach(b=>{if(b.ttl>0 && rco(m,b)){b.ttl=0; hit=true}}); return !hit}); CNS.forEach(cn=>{if(!cn.t && rco({x:P.x,y:P.y,w:P.w,h:P.h},cn)){cn.t=true; S.coins+=cn.v; ui()}}); if(P.y>H+40){S.lives=Math.max(0,S.lives-1); gen(S.lvl)} if(Math.hypot(P.x+P.w/2-PORT.x,P.y+P.h/2-PORT.y)<PORT.r+20){S.coins+=10; if((S.lvl+1)%2==0) S.gems+=4; S.lvl++; gen(S.lvl)} x.fillStyle=bg(S.lvl); x.fillRect(0,0,W,H); x.fillStyle='#8B4513'; x.fillRect(0,H-80,W,80); x.fillStyle=bg(S.lvl); GAPS.forEach(g=>x.fillRect(g.x,H-80,g.w,80)); x.fillStyle='#2ecc71'; let lx=0; [...GAPS].sort((a,b)=>a.x-b.x).forEach(g=>{x.fillRect(lx,H-80,g.x-lx,20); lx=g.x+g.w}); x.fillRect(lx,H-80,W-lx,20); CNS.forEach(cn=>{if(cn.t)return; x.beginPath(); x.arc(cn.x,cn.y,cn.r,0,Math.PI*2); x.fillStyle='#ffd54f'; x.fill(); x.lineWidth=2; x.strokeStyle='#f39c12'; x.stroke()}); const grad=x.createRadialGradient(PORT.x,PORT.y,4,PORT.x,PORT.y,PORT.r); grad.addColorStop(0,'#9b59b6'); grad.addColorStop(1,'#2c3e50'); x.fillStyle=grad; x.beginPath(); x.arc(PORT.x,PORT.y,PORT.r,0,Math.PI*2); x.fill(); x.fillStyle='#e74c3c'; M.forEach(m=>{x.fillRect(m.x,m.y,m.w,m.h)}); x.fillStyle='#ecf0f1'; bullets.forEach(b=>{x.beginPath(); x.arc(b.x,b.y,6,0,Math.PI*2); x.fill()}); x.fillStyle='#f39c12'; x.fillRect(P.x,P.y,P.w,P.h); x.fillStyle='#2c3e50'; x.fillRect(P.x+(P.face>0?-6:P.w-8),P.y+6,6,20)} gen(1); ui(); if(!localStorage.getItem('tmr_first')){document.getElementById('auth').style.display='flex'; localStorage.setItem('tmr_first','1')} step();</script></body></html>